<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body><pre>array (
  'item' => '664',
  'town' => '2',
  'keyword' => '',
  'user' => 'guest',
  'new_firm_id' => 0,
  'new_firm_name' => '',
  'new_firm_item_name' => '',
  'query_str' => false,
)<hr>array (
  0 => 
  array (
    'query' => 'set @keylist = ucase(?)',
    'values' => 
    array (
      0 => 's',
      1 => false,
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 1,
    'field_count' => 0,
    'Execution time' => 0.00097584724426269531,
    'Transfer time' => 0,
  ),
  1 => 
  array (
    'query' => 'set @key=\'\'',
    'values' => 
    array (
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 0,
    'Execution time' => 0,
    'Transfer time' => 0,
  ),
  2 => 
  array (
    'query' => 'create temporary table keywords
select @key:=substr(@keylist,1,instr(concat(@keylist,\'|\'),\'|\')-1) keyword,
       @keylist:=substr(@keylist,instr(concat(@keylist,\'|\'),\'|\')+1,255) dummy
  from  firm
 where @keylist!=\'\'',
    'values' => 
    array (
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 0,
    'Execution time' => 0.097656965255737305,
    'Transfer time' => 0,
  ),
  3 => 
  array (
    'query' => 'delete from keywords where char_length(keyword)<3',
    'values' => 
    array (
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 0,
    'Execution time' => 0.00097608566284179688,
    'Transfer time' => 0,
  ),
  4 => 
  array (
    'query' => 'create temporary table fresult
as
select max(if(char_length(?)<3,1,relevance(upper(?),concat_ws(\' \',firm_name,item_name,address,phone)))) as relevance,               
               firm_id
          from vfirm
          left join keywords k on concat_ws(\' \',firm_name,item_name,address,phone) like concat(\'%\',k.keyword,\'%\')
         where (town_id=? or ?=0)
           and (item_id=? or ?=0)
           and (char_length(?)<3 or k.keyword is not null)
 group by firm_id
having max(if(char_length(?)<3,1,relevance(upper(?),concat_ws(\' \',firm_name,item_name,address,phone))))>0
 order by 1 desc
 limit 100; ',
    'values' => 
    array (
      0 => 'ssddddsss',
      1 => false,
      2 => false,
      3 => '2',
      4 => '2',
      5 => '664',
      6 => '664',
      7 => false,
      8 => false,
      9 => false,
    ),
    'affected_rows' => 5,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 9,
    'field_count' => 0,
    'Execution time' => 1.0166020393371582,
    'Transfer time' => 0,
  ),
  5 => 
  array (
    'query' => 'select f.*
  from fresult r
 inner join firm f on f.firm_id=r.firm_id
order by r.relevance desc;',
    'values' => 
    array (
    ),
    'affected_rows' => 5,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 3,
    'Execution time' => 0.00097608566284179688,
    'Transfer time' => 0,
  ),
  6 => 
  array (
    'query' => 'select r.firm_id,c.*
  from fresult r
 inner join firm_div d on d.firm_id=r.firm_id
 inner join catalog_item c on c.item_id=d.item_id',
    'values' => 
    array (
    ),
    'affected_rows' => 36,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 3,
    'Execution time' => 0.00097703933715820312,
    'Transfer time' => 0,
  ),
  7 => 
  array (
    'query' => 'SELECT r.firm_id,t.town_name, s.street_name, CONCAT (a.building,bletter) building,  CONCAT (a.office,oletter) office
  from fresult r
 INNER JOIN firm_address a ON a.firm_id=r.firm_id
 INNER JOIN street s ON a.street_id=s.street_id
 INNER JOIN town t ON s.town_id=t.town_id
order by 2,3,4,5',
    'values' => 
    array (
    ),
    'affected_rows' => 6,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 5,
    'Execution time' => 0.00097703933715820312,
    'Transfer time' => 0,
  ),
  8 => 
  array (
    'query' => 'select p.*
  from fresult r
 inner join firm_phone p on p.firm_id=r.firm_id
order by phone_code,phone_number;',
    'values' => 
    array (
    ),
    'affected_rows' => 7,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 6,
    'Execution time' => 0.0019528865814208984,
    'Transfer time' => 0,
  ),
)<hr>array (
  'sync' => 
  array (
    0 => 
    array (
      'firms' => 'true',
    ),
  ),
  'state' => 
  array (
    'item' => '664',
    'town' => '2',
    'keyword' => '',
    'user' => 'guest',
    'new_firm_id' => 0,
    'new_firm_name' => '',
    'new_firm_item_name' => '',
    'query_str' => false,
  ),
  'nodes' => 
  array (
    'firms' => 
    array (
      0 => 
      array (
        'firm' => 
        array (
          'firm_id' => 402,
          'firm_name' => 'BIZCOM, ТОО',
          'firm_descr' => '',
        ),
      ),
      1 => 
      array (
        'firm' => 
        array (
          'firm_id' => 3700,
          'firm_name' => 'ВК ПРЕДПРИЯТИЕ ВЫЧИСЛИТЕЛЬНОЙ ТЕХНИКИ И СИСТЕМ УПРАВЛЕНИЯ, ТОО',
          'firm_descr' => '',
        ),
      ),
      2 => 
      array (
        'firm' => 
        array (
          'firm_id' => 5762,
          'firm_name' => 'КИП, АВТОРИЗОВАННЫЙ СЕРВИСНЫЙ ЦЕНТР',
          'firm_descr' => '',
        ),
      ),
      3 => 
      array (
        'firm' => 
        array (
          'firm_id' => 7427,
          'firm_name' => 'ОТКРЫТЫЕ ТЕХНОЛОГИИ ПЛЮС, ТОО',
          'firm_descr' => '',
        ),
      ),
      4 => 
      array (
        'firm' => 
        array (
          'firm_id' => 7851,
          'firm_name' => 'ПРЕДПРИЯТИЕ КС, ТОО',
          'firm_descr' => '',
        ),
      ),
      5 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 655,
          'item_name' => 'КАРТРИДЖИ - ЗАПРАВКА',
        ),
      ),
      6 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 664,
          'item_name' => 'КОМПЬЮТЕРНЫЕ СЕТИ',
        ),
      ),
      7 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 665,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - ПРОДАЖА',
        ),
      ),
      8 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 666,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - РЕМОНТ, СЕРВИС',
        ),
      ),
      9 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 671,
          'item_name' => 'КОПИРОВАЛЬНАЯ ТЕХНИКА - ПРОДАЖА, РЕМОНТ',
        ),
      ),
      10 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 333,
          'item_name' => 'ПОЖАРНАЯ БЕЗОПАСНОСТЬ - ОБОРУДОВАНИЕ, СИГНАЛИЗАЦИЯ',
        ),
      ),
      11 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 753,
          'item_name' => 'ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ',
        ),
      ),
      12 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 402,
          'item_name' => 'СИСТЕМЫ БЕЗОПАСНОСТИ, ВИДЕОНАБЛЮДЕНИЯ',
        ),
      ),
      13 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 835,
          'item_name' => 'ЦИФРОВАЯ ТЕХНИКА - ПРОДАЖА',
        ),
      ),
      14 => 
      array (
        'item' => 
        array (
          'firm_id' => 402,
          'item_id' => 836,
          'item_name' => 'ЦИФРОВАЯ ТЕХНИКА - РЕМОНТ',
        ),
      ),
      15 => 
      array (
        'item' => 
        array (
          'firm_id' => 3700,
          'item_id' => 543,
          'item_name' => '1С: БУХГАЛТЕРИЯ',
        ),
      ),
      16 => 
      array (
        'item' => 
        array (
          'firm_id' => 3700,
          'item_id' => 81,
          'item_name' => 'БУХГАЛТЕРСКИЕ УСЛУГИ',
        ),
      ),
      17 => 
      array (
        'item' => 
        array (
          'firm_id' => 3700,
          'item_id' => 655,
          'item_name' => 'КАРТРИДЖИ - ЗАПРАВКА',
        ),
      ),
      18 => 
      array (
        'item' => 
        array (
          'firm_id' => 3700,
          'item_id' => 664,
          'item_name' => 'КОМПЬЮТЕРНЫЕ СЕТИ',
        ),
      ),
      19 => 
      array (
        'item' => 
        array (
          'firm_id' => 3700,
          'item_id' => 666,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - РЕМОНТ, СЕРВИС',
        ),
      ),
      20 => 
      array (
        'item' => 
        array (
          'firm_id' => 3700,
          'item_id' => 671,
          'item_name' => 'КОПИРОВАЛЬНАЯ ТЕХНИКА - ПРОДАЖА, РЕМОНТ',
        ),
      ),
      21 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 600,
          'item_name' => 'БЫТОВАЯ ТЕХНИКА - РЕМОНТ',
        ),
      ),
      22 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 655,
          'item_name' => 'КАРТРИДЖИ - ЗАПРАВКА',
        ),
      ),
      23 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 664,
          'item_name' => 'КОМПЬЮТЕРНЫЕ СЕТИ',
        ),
      ),
      24 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 666,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - РЕМОНТ, СЕРВИС',
        ),
      ),
      25 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 668,
          'item_name' => 'КОНДИЦИОНЕРЫ - ПРОДАЖА, РЕМОНТ, ОБСЛУЖИВАНИЕ',
        ),
      ),
      26 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 671,
          'item_name' => 'КОПИРОВАЛЬНАЯ ТЕХНИКА - ПРОДАЖА, РЕМОНТ',
        ),
      ),
      27 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 263,
          'item_name' => 'МОБИЛЬНЫЕ ТЕЛЕФОНЫ - РЕМОНТ',
        ),
      ),
      28 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 446,
          'item_name' => 'ТЕЛЕФОННЫЕ АППАРАТЫ - РЕМОНТ',
        ),
      ),
      29 => 
      array (
        'item' => 
        array (
          'firm_id' => 5762,
          'item_id' => 836,
          'item_name' => 'ЦИФРОВАЯ ТЕХНИКА - РЕМОНТ',
        ),
      ),
      30 => 
      array (
        'item' => 
        array (
          'firm_id' => 7427,
          'item_id' => 655,
          'item_name' => 'КАРТРИДЖИ - ЗАПРАВКА',
        ),
      ),
      31 => 
      array (
        'item' => 
        array (
          'firm_id' => 7427,
          'item_id' => 664,
          'item_name' => 'КОМПЬЮТЕРНЫЕ СЕТИ',
        ),
      ),
      32 => 
      array (
        'item' => 
        array (
          'firm_id' => 7427,
          'item_id' => 665,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - ПРОДАЖА',
        ),
      ),
      33 => 
      array (
        'item' => 
        array (
          'firm_id' => 7427,
          'item_id' => 666,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - РЕМОНТ, СЕРВИС',
        ),
      ),
      34 => 
      array (
        'item' => 
        array (
          'firm_id' => 7427,
          'item_id' => 668,
          'item_name' => 'КОНДИЦИОНЕРЫ - ПРОДАЖА, РЕМОНТ, ОБСЛУЖИВАНИЕ',
        ),
      ),
      35 => 
      array (
        'item' => 
        array (
          'firm_id' => 7427,
          'item_id' => 671,
          'item_name' => 'КОПИРОВАЛЬНАЯ ТЕХНИКА - ПРОДАЖА, РЕМОНТ',
        ),
      ),
      36 => 
      array (
        'item' => 
        array (
          'firm_id' => 7851,
          'item_id' => 664,
          'item_name' => 'КОМПЬЮТЕРНЫЕ СЕТИ',
        ),
      ),
      37 => 
      array (
        'item' => 
        array (
          'firm_id' => 7851,
          'item_id' => 665,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - ПРОДАЖА',
        ),
      ),
      38 => 
      array (
        'item' => 
        array (
          'firm_id' => 7851,
          'item_id' => 666,
          'item_name' => 'КОМПЬЮТЕРЫ, ОРГТЕХНИКА - РЕМОНТ, СЕРВИС',
        ),
      ),
      39 => 
      array (
        'item' => 
        array (
          'firm_id' => 7851,
          'item_id' => 671,
          'item_name' => 'КОПИРОВАЛЬНАЯ ТЕХНИКА - ПРОДАЖА, РЕМОНТ',
        ),
      ),
      40 => 
      array (
        'item' => 
        array (
          'firm_id' => 7851,
          'item_id' => 753,
          'item_name' => 'ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ',
        ),
      ),
      41 => 
      array (
        'address' => 
        array (
          'firm_id' => 3700,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => '30-й Гвардейской дивизии',
          'building' => '18',
          'office' => NULL,
        ),
      ),
      42 => 
      array (
        'address' => 
        array (
          'firm_id' => 7427,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => 'Белинского',
          'building' => '46',
          'office' => NULL,
        ),
      ),
      43 => 
      array (
        'address' => 
        array (
          'firm_id' => 5762,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => 'Потанина',
          'building' => '272',
          'office' => NULL,
        ),
      ),
      44 => 
      array (
        'address' => 
        array (
          'firm_id' => 5762,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => 'Потанина',
          'building' => '311',
          'office' => NULL,
        ),
      ),
      45 => 
      array (
        'address' => 
        array (
          'firm_id' => 7851,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => 'пр. Ауэзова',
          'building' => '37',
          'office' => NULL,
        ),
      ),
      46 => 
      array (
        'address' => 
        array (
          'firm_id' => 402,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => 'пр. Независимости',
          'building' => '74',
          'office' => NULL,
        ),
      ),
      47 => 
      array (
        'phone' => 
        array (
          'phone_id' => 8872,
          'firm_id' => 3700,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '222222',
          'phone_description' => '',
        ),
      ),
      48 => 
      array (
        'phone' => 
        array (
          'phone_id' => 9373,
          'firm_id' => 402,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '245188',
          'phone_description' => '',
        ),
      ),
      49 => 
      array (
        'phone' => 
        array (
          'phone_id' => 9530,
          'firm_id' => 7851,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '250966',
          'phone_description' => '',
        ),
      ),
      50 => 
      array (
        'phone' => 
        array (
          'phone_id' => 11005,
          'firm_id' => 7427,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '522727',
          'phone_description' => '',
        ),
      ),
      51 => 
      array (
        'phone' => 
        array (
          'phone_id' => 11032,
          'firm_id' => 402,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '523255',
          'phone_description' => '',
        ),
      ),
      52 => 
      array (
        'phone' => 
        array (
          'phone_id' => 12728,
          'firm_id' => 5762,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '766244',
          'phone_description' => '',
        ),
      ),
      53 => 
      array (
        'phone' => 
        array (
          'phone_id' => 12852,
          'firm_id' => 5762,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '767951',
          'phone_description' => '',
        ),
      ),
    ),
  ),
)</pre></body><html>