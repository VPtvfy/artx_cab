<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body><pre>array (
  'item' => '259',
  'town' => '2',
  'keyword' => '',
  'user' => 'guest',
  'find' => '',
  'query_str' => false,
)<hr>array (
  0 => 
  array (
    'query' => 'set @keylist = ucase(?)',
    'values' => 
    array (
      0 => 's',
      1 => false,
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 1,
    'field_count' => 0,
    'Execution time' => 0.00097703933715820312,
    'Transfer time' => 0,
  ),
  1 => 
  array (
    'query' => 'set @key=\'\'',
    'values' => 
    array (
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 0,
    'Execution time' => 0.00097584724426269531,
    'Transfer time' => 0,
  ),
  2 => 
  array (
    'query' => 'create temporary table keywords
select @key:=substr(@keylist,1,instr(concat(@keylist,\'|\'),\'|\')-1) keyword,
       @keylist:=substr(@keylist,instr(concat(@keylist,\'|\'),\'|\')+1,255) dummy
  from  firm
 where @keylist!=\'\'',
    'values' => 
    array (
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 0,
    'Execution time' => 0.1142580509185791,
    'Transfer time' => 0,
  ),
  3 => 
  array (
    'query' => 'delete from keywords where char_length(keyword)<3',
    'values' => 
    array (
    ),
    'affected_rows' => 0,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 0,
    'Execution time' => 0,
    'Transfer time' => 0,
  ),
  4 => 
  array (
    'query' => 'create temporary table fresult
as
select max(if(char_length(?)<3,1,relevance(upper(?),concat_ws(\' \',firm_name,item_name,address,phone)))) as relevance,               
               firm_id
          from vfirm
          left join keywords k on concat_ws(\' \',firm_name,item_name,address,phone) like concat(\'%\',k.keyword,\'%\')
         where (town_id=? or ?=0)
           and (item_id=? or ?=0)
           and (char_length(?)<3 or k.keyword is not null)
 group by firm_id
having max(if(char_length(?)<3,1,relevance(upper(?),concat_ws(\' \',firm_name,item_name,address,phone))))>0
 order by 1 desc
 limit 100; ',
    'values' => 
    array (
      0 => 'ssddddsss',
      1 => false,
      2 => false,
      3 => '2',
      4 => '2',
      5 => '259',
      6 => '259',
      7 => false,
      8 => false,
      9 => false,
    ),
    'affected_rows' => 2,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 9,
    'field_count' => 0,
    'Execution time' => 1.0566408634185791,
    'Transfer time' => 0,
  ),
  5 => 
  array (
    'query' => 'select f.*
  from fresult r
 inner join firm f on f.firm_id=r.firm_id
order by r.relevance desc,f.firm_name;',
    'values' => 
    array (
    ),
    'affected_rows' => 2,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 3,
    'Execution time' => 0.00097703933715820312,
    'Transfer time' => 0,
  ),
  6 => 
  array (
    'query' => 'select r.firm_id,c.*
  from fresult r
 inner join firm_div d on d.firm_id=r.firm_id
 inner join catalog_item c on c.item_id=d.item_id',
    'values' => 
    array (
    ),
    'affected_rows' => 10,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 3,
    'Execution time' => 0,
    'Transfer time' => 0.00097680091857910156,
  ),
  7 => 
  array (
    'query' => 'SELECT r.firm_id,t.town_name, s.street_name, CONCAT (a.building,bletter) building,  CONCAT (a.office,oletter) office
  from fresult r
 INNER JOIN firm_address a ON a.firm_id=r.firm_id
 INNER JOIN street s ON a.street_id=s.street_id
 INNER JOIN town t ON s.town_id=t.town_id
order by 2,3,4,5',
    'values' => 
    array (
    ),
    'affected_rows' => 2,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 5,
    'Execution time' => 0.00097608566284179688,
    'Transfer time' => 0,
  ),
  8 => 
  array (
    'query' => 'select p.*
  from fresult r
 inner join firm_phone p on p.firm_id=r.firm_id
order by phone_code,phone_number;',
    'values' => 
    array (
    ),
    'affected_rows' => 4,
    'insert_id' => 0,
    'num_rows' => 0,
    'param_count' => 0,
    'field_count' => 6,
    'Execution time' => 0.00097703933715820312,
    'Transfer time' => 0.00097608566284179688,
  ),
)<hr>array (
  'sync' => 
  array (
    0 => 
    array (
      'firms' => 'true',
    ),
  ),
  'state' => 
  array (
    'item' => '259',
    'town' => '2',
    'keyword' => '',
    'user' => 'guest',
    'find' => '',
    'query_str' => false,
  ),
  'nodes' => 
  array (
    'firms' => 
    array (
      0 => 
      array (
        'firm' => 
        array (
          'firm_id' => 3691,
          'firm_name' => 'ВК ОБЛАСТНОЙ ДЕПАРТАМЕНТ КОМИТЕТА ТЕХНИЧЕСКОГО РЕГУЛИРОВАНИЯ И МЕТРОЛОГИИ',
          'firm_descr' => '',
        ),
      ),
      1 => 
      array (
        'firm' => 
        array (
          'firm_id' => 3897,
          'firm_name' => 'ВОСТОКЭНЕРГОСЕРВИС, ТОО',
          'firm_descr' => '',
        ),
      ),
      2 => 
      array (
        'item' => 
        array (
          'firm_id' => 3691,
          'item_id' => 126,
          'item_name' => 'ДЕПАРТАМЕНТЫ',
        ),
      ),
      3 => 
      array (
        'item' => 
        array (
          'firm_id' => 3691,
          'item_id' => 259,
          'item_name' => 'МЕТРОЛОГИЯ',
        ),
      ),
      4 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 170,
          'item_name' => 'ИЗМЕРИТЕЛЬНЫЕ ПРИБОРЫ',
        ),
      ),
      5 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 259,
          'item_name' => 'МЕТРОЛОГИЯ',
        ),
      ),
      6 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 332,
          'item_name' => 'ПОВЕРКА СРЕДСТВ ИЗМЕРЕНИЙ',
        ),
      ),
      7 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 359,
          'item_name' => 'РАДИОСВЯЗЬ',
        ),
      ),
      8 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 439,
          'item_name' => 'СЧЕТЧИКИ ГАЗА, ВОДЫ, ТЕПЛА, ПАРА, ЭЛЕКТРИЧЕСТВА',
        ),
      ),
      9 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 498,
          'item_name' => 'ЭЛЕКТРОИЗМЕРИТЕЛЬНЫЕ ПРИБОРЫ',
        ),
      ),
      10 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 501,
          'item_name' => 'ЭЛЕКТРОТЕХНИЧЕСКОЕ ОБОРУДОВАНИЕ',
        ),
      ),
      11 => 
      array (
        'item' => 
        array (
          'firm_id' => 3897,
          'item_id' => 505,
          'item_name' => 'ЭНЕРГЕТИЧЕСКОЕ ОБОРУДОВАНИЕ',
        ),
      ),
      12 => 
      array (
        'address' => 
        array (
          'firm_id' => 3691,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => 'Казахстан',
          'building' => '5',
          'office' => NULL,
        ),
      ),
      13 => 
      array (
        'address' => 
        array (
          'firm_id' => 3897,
          'town_name' => 'Усть-Каменогорск',
          'street_name' => 'Краснознаменная',
          'building' => '149Б',
          'office' => NULL,
        ),
      ),
      14 => 
      array (
        'phone' => 
        array (
          'phone_id' => 8936,
          'firm_id' => 3897,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '224929',
          'phone_description' => '',
        ),
      ),
      15 => 
      array (
        'phone' => 
        array (
          'phone_id' => 10371,
          'firm_id' => 3691,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '267358',
          'phone_description' => '',
        ),
      ),
      16 => 
      array (
        'phone' => 
        array (
          'phone_id' => 12972,
          'firm_id' => 3897,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '772511',
          'phone_description' => '',
        ),
      ),
      17 => 
      array (
        'phone' => 
        array (
          'phone_id' => 12986,
          'firm_id' => 3897,
          'phone_type' => 1,
          'phone_code' => '7232',
          'phone_number' => '772862',
          'phone_description' => '',
        ),
      ),
    ),
  ),
)</pre></body><html>